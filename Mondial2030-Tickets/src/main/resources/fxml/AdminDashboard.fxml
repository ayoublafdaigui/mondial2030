<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.mondial2030.controller.AdminDashboardController"
            styleClass="dashboard-container">
    
    <!-- TOP: Header Bar -->
    <top>
        <HBox styleClass="header-bar" alignment="CENTER_LEFT" spacing="20">
            <padding>
                <Insets top="15" right="20" bottom="15" left="20"/>
            </padding>
            
            <Button text="ðŸ " onAction="#handleBackToHome" styleClass="nav-link" style="-fx-font-size: 18px;"/>
            <Label text="ðŸŸï¸" style="-fx-font-size: 24px;"/>
            <Label text="Mondial 2030 - Tableau de Bord Administrateur" styleClass="header-title"/>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <Label fx:id="userInfoLabel" styleClass="user-info"/>
            <Button text="ðŸ”„ Actualiser" onAction="#handleRefresh" styleClass="secondary-button"/>
            <Button text="ðŸšª DÃ©connexion" onAction="#handleLogout" styleClass="danger-button"/>
        </HBox>
    </top>
    
    <!-- CENTER: Main Content -->
    <center>
        <VBox spacing="20">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            
            <!-- Spectator Flow Section -->
            <VBox styleClass="section-card" spacing="10">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="ðŸ“Š Flux des Spectateurs &amp; Billets en temps rÃ©el" styleClass="section-title"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Label fx:id="statsLabel" styleClass="stats-label"/>
                    <Button text="ðŸ” Analyser Fraude" onAction="#handleAnalyzeFraud" styleClass="warning-button"/>
                </HBox>
                
                <TableView fx:id="ticketTable" VBox.vgrow="ALWAYS" minHeight="300" styleClass="data-table">
                    <columns>
                        <TableColumn fx:id="colId" text="ID" prefWidth="50"/>
                        <TableColumn fx:id="colOwner" text="PropriÃ©taire" prefWidth="150"/>
                        <TableColumn fx:id="colMatch" text="Match" prefWidth="180"/>
                        <TableColumn fx:id="colSeat" text="Place" prefWidth="100"/>
                        <TableColumn fx:id="colFraudScore" text="Score Fraude IA" prefWidth="120"/>
                        <TableColumn fx:id="colBlockchain" text="Hash Blockchain" prefWidth="180"/>
                        <TableColumn fx:id="colStatus" text="Statut" prefWidth="80"/>
                    </columns>
                </TableView>
            </VBox>
        </VBox>
    </center>
    
    <!-- RIGHT: Forms Panel -->
    <right>
        <VBox spacing="20" prefWidth="320" styleClass="side-panel">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            
            <!-- Generate Ticket Section -->
            <VBox styleClass="form-card" spacing="10">
                <Label text="ðŸŽ« GÃ©nÃ©rer Billet" styleClass="form-card-title"/>
                
                <VBox spacing="5">
                    <Label text="Match"/>
                    <ComboBox fx:id="matchComboBox" maxWidth="Infinity" promptText="SÃ©lectionner un match"/>
                </VBox>
                
                <VBox spacing="5">
                    <Label text="Spectateur"/>
                    <ComboBox fx:id="userComboBox" maxWidth="Infinity" promptText="SÃ©lectionner un utilisateur"/>
                </VBox>
                
                <VBox spacing="5">
                    <Label text="Place (ex: Zone A, Rang 12)"/>
                    <TextField fx:id="seatField" promptText="NumÃ©ro de place"/>
                </VBox>
                
                <HBox spacing="10">
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Prix (â‚¬)"/>
                        <TextField fx:id="priceField" promptText="100.00"/>
                    </VBox>
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="CatÃ©gorie"/>
                        <ComboBox fx:id="categoryComboBox" maxWidth="Infinity"/>
                    </VBox>
                </HBox>
                
                <Button fx:id="generateButton" text="âœ¨ GÃ©nÃ©rer Billet (Secured)" 
                        onAction="#handleGenerateTicket" styleClass="primary-button" maxWidth="Infinity"/>
            </VBox>
            
            <Separator/>
            
            <!-- Transfer Section -->
            <VBox styleClass="form-card" spacing="10">
                <Label text="ðŸ”„ Transfert de Billet" styleClass="form-card-title"/>
                
                <Label text="SÃ©lectionnez un billet dans la table ci-dessus" styleClass="hint-label"/>
                
                <VBox spacing="5">
                    <Label text="Nouveau propriÃ©taire"/>
                    <ComboBox fx:id="transferToComboBox" maxWidth="Infinity" promptText="SÃ©lectionner destinataire"/>
                </VBox>
                
                <VBox spacing="5">
                    <Label text="Prix de transfert (optionnel)"/>
                    <TextField fx:id="transferPriceField" promptText="Prix en â‚¬"/>
                </VBox>
                
                <Button fx:id="transferButton" text="ðŸ“¤ TransfÃ©rer SÃ©lection" 
                        onAction="#handleTransferTicket" styleClass="secondary-button" maxWidth="Infinity" disable="true"/>
            </VBox>
        </VBox>
    </right>
    
    <!-- BOTTOM: Status Bar -->
    <bottom>
        <HBox styleClass="status-bar" alignment="CENTER_LEFT" spacing="30">
            <padding>
                <Insets top="10" right="20" bottom="10" left="20"/>
            </padding>
            
            <Label fx:id="aiStatusLabel" text="SystÃ¨me IA: Actif" styleClass="status-active"/>
            <Separator orientation="VERTICAL"/>
            <Label fx:id="blockchainStatusLabel" text="Blockchain Node: ConnectÃ©" styleClass="status-blockchain"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label text="Mondial 2030 - v1.0" styleClass="version-label"/>
        </HBox>
    </bottom>
    
</BorderPane>
